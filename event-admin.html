<!DOCTYPE html>
<html lang="ta">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Events + Admin Management (Demo)</title>
  <style>
    *{box-sizing:border-box;margin:0;padding:0}
    body{font-family:Inter,Segoe UI,Roboto,Arial;background:#f4f7fb;color:#0f172a;padding:18px}
    header{display:flex;justify-content:space-between;align-items:center;gap:12px;margin-bottom:14px}
    h1{font-size:1.35rem}
    .subtitle{color:#556;text-size:0.95rem}
    .controls{display:flex;gap:8px;align-items:center}
    input,select,textarea,button{font-family:inherit}
    input.search{padding:8px 10px;border-radius:10px;border:1px solid #e2e8f0;min-width:210px}
    .grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(260px,1fr));gap:14px;margin-top:16px}
    .card{background:#fff;padding:12px;border-radius:12px;box-shadow:0 6px 18px rgba(20,20,40,0.06);display:flex;flex-direction:column;gap:8px;min-height:160px}
    .badge{font-size:0.8rem;padding:6px 8px;border-radius:8px;background:linear-gradient(90deg,#60a5fa,#34d399);color:#fff;display:inline-block}
    .event-title{font-weight:700}
    .meta{color:#475569;font-size:0.9rem}
    .rating{display:flex;align-items:center;gap:8px}
    .price{font-weight:700;color:#0b5394}
    .actions{margin-top:auto;display:flex;justify-content:space-between;gap:8px;align-items:center}
    .btn{padding:8px 10px;border-radius:10px;border:0;cursor:pointer;font-weight:700;background:#0b73ff;color:#fff}
    .btn.secondary{background:#eef2ff;color:#0b73ff;border:1px solid rgba(11,115,255,0.12)}
    /* admin area */
    .admin-bar{display:flex;gap:8px;align-items:center}
    .panel{background:#fff;border-radius:12px;padding:14px;margin-top:16px;box-shadow:0 8px 30px rgba(2,6,23,0.06)}
    .panel h2{font-size:1rem;margin-bottom:8px}
    .table{width:100%;border-collapse:collapse}
    .table th,.table td{padding:8px;border-bottom:1px solid #eef2f6;text-align:left;font-size:0.95rem}
    .small{font-size:0.85rem;color:#64748b}
    /* modal */
    .modal-backdrop{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:rgba(6,10,20,0.5);z-index:60}
    .modal{width:100%;max-width:620px;background:#fff;border-radius:12px;padding:16px}
    .close-btn{background:transparent;border:0;cursor:pointer;font-size:1.2rem}
    .success{padding:12px;border-radius:8px;background:#dcfce7;color:#064e3b;font-weight:700;text-align:center}
    /* responsive */
    @media(max-width:520px){header{flex-direction:column;align-items:flex-start;gap:8px}}
  </style>
</head>
<body>

  <header>
    <div>
      <h1>Events Portal</h1>
      <div class="subtitle">Book events — Admin can manage events & bookings (Demo)</div>
    </div>

    <div class="controls">
      <input id="searchInput" class="search" placeholder="Search events..." />
      <select id="sortSelect" title="Sort">
        <option value="popular">Most Popular</option>
        <option value="price-asc">Price Low → High</option>
        <option value="price-desc">Price High → Low</option>
        <option value="date">Date</option>
      </select>

      <div id="userArea" style="display:flex;align-items:center;gap:8px">
        <button id="loginAdminBtn" class="btn secondary">Admin Login</button>
      </div>
    </div>
  </header>

  <main>
    <div id="userView">
      <div id="grid" class="grid" aria-live="polite"></div>
    </div>

    <!-- Admin panel (hidden until admin login) -->
    <div id="adminView" style="display:none">
      <div class="admin-bar">
        <div style="flex:1">
          <h2 style="margin-bottom:8px">Admin Dashboard</h2>
        </div>
        <div style="display:flex;gap:8px">
          <button id="showAddEvent" class="btn">+ Add Event</button>
          <button id="viewBookingsBtn" class="btn secondary">View Bookings</button>
          <button id="viewUsersBtn" class="btn secondary">View Users</button>
          <button id="adminLogout" class="btn" style="background:#ef4444">Logout</button>
        </div>
      </div>

      <div id="adminPanelsContainer"></div>
    </div>
  </main>

  <!-- Payment / Booking Modal -->
  <div id="modalBackdrop" class="modal-backdrop" role="dialog" aria-modal="true" aria-hidden="true">
    <div class="modal" role="document">
      <header style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px">
        <div>
          <div id="modalEventTitle" style="font-weight:800"></div>
          <div id="modalEventMeta" class="small"></div>
        </div>
        <div><button class="close-btn" id="modalClose">&times;</button></div>
      </header>

      <form id="paymentForm" novalidate>
        <div style="display:flex;gap:10px;align-items:center;margin-bottom:8px">
          <div class="badge" id="modalPrice">₹0</div>
          <div style="flex:1">
            <label for="name">பெயர்</label>
            <input id="name" type="text" placeholder="உங்கள் பெயர்" style="width:100%;padding:8px;border-radius:8px;border:1px solid #e2e8f0" required />
          </div>
        </div>

        <div style="display:flex;gap:10px;margin-bottom:8px">
          <div style="flex:1">
            <label for="email">Email</label>
            <input id="email" type="email" placeholder="you@example.com" style="width:100%;padding:8px;border-radius:8px;border:1px solid #e2e8f0" required />
          </div>
          <div style="width:120px">
            <label for="tickets">Tickets</label>
            <select id="tickets" style="width:100%;padding:8px;border-radius:8px;border:1px solid #e2e8f0">
              <option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option>
            </select>
          </div>
        </div>

        <!-- fake card for demo -->
        <div style="margin-bottom:8px">
          <label for="card">Card Number (demo)</label>
          <input id="card" type="text" placeholder="4111 1111 1111 1111" maxlength="19" style="width:100%;padding:8px;border-radius:8px;border:1px solid #e2e8f0" required />
        </div>

        <div style="display:flex;gap:8px;align-items:center;margin-bottom:8px">
          <input id="payBtn" class="btn" type="submit" value="Pay & Book" />
          <button id="payLater" type="button" class="btn secondary">Pay at Venue</button>
        </div>

        <div id="paymentResult" style="display:none;margin-top:8px"></div>
      </form>
    </div>
  </div>

  <!-- Admin login modal -->
  <div id="adminLoginBackdrop" class="modal-backdrop" role="dialog" aria-hidden="true">
    <div class="modal">
      <header style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px">
        <div><strong>Admin Login</strong></div>
        <div><button class="close-btn" id="adminLoginClose">&times;</button></div>
      </header>
      <div style="margin-bottom:8px"><small>Use password <code>admin123</code> for demo.</small></div>
      <div style="display:flex;gap:8px;align-items:center">
        <input id="adminPassword" type="password" placeholder="Password" style="flex:1;padding:8px;border-radius:8px;border:1px solid #e2e8f0" />
        <button id="adminLoginSubmit" class="btn">Login</button>
      </div>
      <div id="adminLoginMsg" class="small" style="margin-top:8px;color:#ef4444;display:none"></div>
    </div>
  </div>

  <script>
    /**************************************************************************
     * Demo app: events + admin management
     * Bookings & events stored in localStorage.
     * Admin password (demo): admin123
     **************************************************************************/

    // --- initial sample events (used only if none in localStorage) ---
    const sampleEvents = [
      { id:1, title:"Summer Music Festival", city:"Chennai", date:"2025-10-12", price:999, rating:4.7, reviews:128, tag:"Music" },
      { id:2, title:"Tech Summit 2025", city:"Bengaluru", date:"2025-11-05", price:2499, rating:4.9, reviews:850, tag:"Tech" },
      { id:3, title:"Food Carnival", city:"Hyderabad", date:"2025-09-30", price:499, rating:4.2, reviews:64, tag:"Food" }
    ];

    // --- storage helpers ---
    function loadEvents(){
      try {
        const raw = localStorage.getItem('events_demo_v1');
        if (!raw) {
          localStorage.setItem('events_demo_v1', JSON.stringify(sampleEvents));
          return sampleEvents.slice();
        }
        return JSON.parse(raw);
      } catch(e){ console.error(e); return sampleEvents.slice(); }
    }
    function saveEvents(arr){ localStorage.setItem('events_demo_v1', JSON.stringify(arr)); }

    function loadBookings(){
      try {
        const raw = localStorage.getItem('bookings_demo_v1');
        return raw ? JSON.parse(raw) : [];
      } catch(e){ console.error(e); return []; }
    }
    function saveBookings(arr){ localStorage.setItem('bookings_demo_v1', JSON.stringify(arr)); }

    // data
    let events = loadEvents();
    let bookings = loadBookings();
    let selectedEvent = null;
    let isAdmin = false;

    // --- renderers ---
    const grid = document.getElementById('grid');
    function renderStars(r){
      const full = Math.floor(r);
      const half = (r - full) >= 0.5;
      let out = '';
      for(let i=0;i<full;i++) out += '★';
      if(half) out += '☆';
      return out;
    }
    function formatDate(d){ const dt = new Date(d+'T00:00:00'); return dt.toLocaleDateString('en-GB',{year:'numeric',month:'short',day:'numeric'}) }

    function renderList(list){
      grid.innerHTML = '';
      if(list.length===0){ grid.innerHTML = '<div style="grid-column:1/-1;padding:16px;background:#fff;border-radius:10px;text-align:center;color:#475569">No events</div>'; return; }
      list.forEach(ev=>{
        const div = document.createElement('div'); div.className='card';
        div.innerHTML = `
          <div style="display:flex;justify-content:space-between;align-items:flex-start">
            <div style="flex:1">
              <div class="event-title">${escapeHtml(ev.title)}</div>
              <div class="meta">${escapeHtml(ev.city)} • ${formatDate(ev.date)}</div>
            </div>
            <div style="text-align:right">
              <div class="badge">${escapeHtml(ev.tag || '')}</div>
              <div style="margin-top:8px" class="price">₹${ev.price}</div>
            </div>
          </div>

          <div class="rating"><div>${renderStars(ev.rating || 0)}</div><div style="color:#334155">${(ev.rating||0).toFixed(1)} <span class="small">(${ev.reviews||0})</span></div></div>

          <div class="actions">
            <div class="small">Date: ${formatDate(ev.date)}</div>
            <div style="display:flex;gap:8px">
              <button class="btn bookBtn" data-id="${ev.id}">Book</button>
              <button class="btn secondary detailsBtn" data-id="${ev.id}">Details</button>
              ${isAdmin ? `<button class="btn secondary delBtn" data-id="${ev.id}" style="background:#fee2e2;color:#b91c1c;border:1px solid #fca5a5">Delete</button>` : ''}
            </div>
          </div>
        `;
        grid.appendChild(div);
      });

      // attach handlers
      document.querySelectorAll('.bookBtn').forEach(b=>b.addEventListener('click', openPayment));
      document.querySelectorAll('.detailsBtn').forEach(b=>b.addEventListener('click', e=>{
        const id = Number(e.currentTarget.dataset.id);
        const ev = events.find(x=>x.id===id);
        alert(`${ev.title}\nWhere: ${ev.city}\nWhen: ${formatDate(ev.date)}\nPrice: ₹${ev.price}\nRating: ${ev.rating}\nTag: ${ev.tag||''}`);
      }));
      document.querySelectorAll('.delBtn').forEach(b=>b.addEventListener('click', e=>{
        const id = Number(e.currentTarget.dataset.id);
        if(!confirm('Delete this event?')) return;
        events = events.filter(x=>x.id!==id);
        saveEvents(events);
        renderList(eventsFiltered());
        showAdminMessage('Event deleted.');
      }));
    }

    // search & sort
    const searchInput = document.getElementById('searchInput');
    const sortSelect = document.getElementById('sortSelect');
    function eventsFiltered(){
      const q = searchInput.value.trim().toLowerCase();
      let filtered = events.filter(ev => (ev.title+' '+ev.city+' '+(ev.tag||'')).toLowerCase().includes(q));
      const sort = sortSelect.value;
      if(sort==='popular') filtered.sort((a,b)=> (b.rating||0)-(a.rating||0) );
      else if(sort==='price-asc') filtered.sort((a,b)=> a.price - b.price);
      else if(sort==='price-desc') filtered.sort((a,b)=> b.price - a.price);
      else if(sort==='date') filtered.sort((a,b)=> new Date(a.date) - new Date(b.date));
      return filtered;
    }
    searchInput.addEventListener('input', ()=>renderList(eventsFiltered()));
    sortSelect.addEventListener('change', ()=>renderList(eventsFiltered()));

    // initial render
    renderList(eventsFiltered());

    // --- payment modal logic ---
    const modalBackdrop = document.getElementById('modalBackdrop');
    const modalClose = document.getElementById('modalClose');
    const modalEventTitle = document.getElementById('modalEventTitle');
    const modalEventMeta = document.getElementById('modalEventMeta');
    const modalPrice = document.getElementById('modalPrice');
    const paymentForm = document.getElementById('paymentForm');
    const paymentResult = document.getElementById('paymentResult');

    function openPayment(e){
      const id = Number(e.currentTarget.dataset.id);
      selectedEvent = events.find(x=>x.id===id);
      modalEventTitle.textContent = selectedEvent.title;
      modalEventMeta.textContent = `${selectedEvent.city} • ${formatDate(selectedEvent.date)}`;
      modalPrice.textContent = `₹${selectedEvent.price}`;
      paymentResult.style.display='none'; paymentForm.style.display='block';
      modalBackdrop.style.display='flex'; modalBackdrop.setAttribute('aria-hidden','false');
      paymentForm.reset(); document.getElementById('name').focus();
    }
    modalClose.addEventListener('click', closeModal);
    modalBackdrop.addEventListener('click', ev=>{ if(ev.target===modalBackdrop) closeModal(); });
    function closeModal(){ modalBackdrop.style.display='none'; modalBackdrop.setAttribute('aria-hidden','true'); }

    paymentForm.addEventListener('submit', function(evt){
      evt.preventDefault();
      const name = document.getElementById('name').value.trim();
      const email = document.getElementById('email').value.trim();
      const tickets = Number(document.getElementById('tickets').value);
      const card = document.getElementById('card').value.replace(/\s+/g,'');
      if(!name||!email){ alert('Name & email required'); return; }
      if(!/^\d{13,19}$/.test(card)) { alert('Demo: enter digits for card'); return; }
      const total = selectedEvent.price * tickets;
      // save booking
      const booking = { id: Date.now(), eventId:selectedEvent.id, eventTitle:selectedEvent.title, name, email, tickets, total, date: new Date().toISOString() };
      bookings.push(booking); saveBookings(bookings);
      // confirmation
      paymentForm.style.display='none'; paymentResult.style.display='block';
      paymentResult.innerHTML = `<div class="success">Payment Successful! Booked ${escapeHtml(selectedEvent.title)} — ${tickets} ticket(s). Paid ₹${total}.</div>`;
      // update admin panels if open
      refreshAdminPanels();
    });

    document.getElementById('payLater').addEventListener('click', ()=>{
      const name = document.getElementById('name').value.trim();
      const email = document.getElementById('email').value.trim();
      const tickets = Number(document.getElementById('tickets').value);
      if(!name||!email){ alert('Name & email required'); return; }
      const total = selectedEvent.price * tickets;
      const booking = { id: Date.now(), eventId:selectedEvent.id, eventTitle:selectedEvent.title, name, email, tickets, total, date: new Date().toISOString(), payAtVenue:true };
      bookings.push(booking); saveBookings(bookings);
      paymentForm.style.display='none'; paymentResult.style.display='block';
      paymentResult.innerHTML = `<div class="success">Booking confirmed. Pay ₹${total} at venue for ${escapeHtml(selectedEvent.title)}.</div>`;
      refreshAdminPanels();
    });

    // card input formatting
    document.getElementById('card').addEventListener('input', e=>{
      let v = e.target.value.replace(/\D/g,'').slice(0,19);
      v = v.match(/.{1,4}/g)?.join(' ') || v;
      e.target.value = v;
    });

    // --- admin login & panels ---
    const adminLoginBackdrop = document.getElementById('adminLoginBackdrop');
    const adminLoginBtn = document.getElementById('loginAdminBtn');
    const adminLoginClose = document.getElementById('adminLoginClose');
    const adminLoginSubmit = document.getElementById('adminLoginSubmit');
    const adminPassword = document.getElementById('adminPassword');
    const adminLoginMsg = document.getElementById('adminLoginMsg');
    const adminView = document.getElementById('adminView');
    const userArea = document.getElementById('userArea');
    const adminPanelsContainer = document.getElementById('adminPanelsContainer');
    const adminLogout = document.getElementById('adminLogout');
    const showAddEvent = document.getElementById('showAddEvent');
    const viewBookingsBtn = document.getElementById('viewBookingsBtn');
    const viewUsersBtn = document.getElementById('viewUsersBtn');

    adminLoginBtn.addEventListener('click', ()=>{ adminLoginBackdrop.style.display='flex'; adminLoginBackdrop.setAttribute('aria-hidden','false'); adminLoginMsg.style.display='none'; adminPassword.value=''; adminPassword.focus();});
    adminLoginClose.addEventListener('click', ()=>{ adminLoginBackdrop.style.display='none'; adminLoginBackdrop.setAttribute('aria-hidden','true'); });
    adminLoginBackdrop.addEventListener('click', e=>{ if(e.target===adminLoginBackdrop){ adminLoginBackdrop.style.display='none'; adminLoginBackdrop.setAttribute('aria-hidden','true'); } });

    adminLoginSubmit.addEventListener('click', ()=> {
      const pwd = adminPassword.value;
      if(pwd === 'admin123'){ // demo password
        isAdmin = true; onAdminLogin();
        adminLoginBackdrop.style.display='none';
      } else {
        adminLoginMsg.textContent = 'Password wrong (demo).';
        adminLoginMsg.style.display = 'block';
      }
    });

    function onAdminLogin(){
      // show admin UI
      adminView.style.display='block';
      userArea.style.display='none';
      renderList(eventsFiltered());
      showAdminMessage('Welcome, Admin');
      refreshAdminPanels();
    }

    adminLogout.addEventListener('click', ()=>{
      if(!confirm('Logout admin?')) return;
      isAdmin = false;
      adminView.style.display='none';
      userArea.style.display='flex';
      renderList(eventsFiltered());
      adminPanelsContainer.innerHTML = '';
    });

    // admin panels management
    function refreshAdminPanels(){
      // if admin not logged in, nothing
      if(!isAdmin) return;
      adminPanelsContainer.innerHTML = '';
      // bookings panel
      const bp = document.createElement('div'); bp.className='panel';
      bp.innerHTML = `<h2>All Bookings (${bookings.length})</h2>`;
      if(bookings.length===0){
        bp.innerHTML += `<div class="small">No bookings yet.</div>`;
      } else {
        let html = `<table class="table"><thead><tr><th>When</th><th>Event</th><th>Name</th><th>Email</th><th>Tickets</th><th>Total</th><th>Action</th></tr></thead><tbody>`;
        bookings.slice().reverse().forEach(b=>{
          html += `<tr data-id="${b.id}"><td class="small">${new Date(b.date).toLocaleString()}</td><td>${escapeHtml(b.eventTitle)}</td><td>${escapeHtml(b.name)}</td><td>${escapeHtml(b.email)}</td><td>${b.tickets}</td><td>₹${b.total}</td><td><button class="btn secondary cancelBooking" data-id="${b.id}">Cancel</button></td></tr>`;
        });
        html += `</tbody></table>`;
        bp.innerHTML += html;
      }
      adminPanelsContainer.appendChild(bp);

      // users panel
      const users = uniqueUsers();
      const up = document.createElement('div'); up.className='panel';
      up.innerHTML = `<h2>Users (${users.length})</h2>`;
      if(users.length===0) up.innerHTML += `<div class="small">No users yet.</div>`;
      else {
        let html = `<table class="table"><thead><tr><th>Name</th><th>Email</th><th>Bookings</th></tr></thead><tbody>`;
        users.forEach(u=> html += `<tr><td>${escapeHtml(u.name)}</td><td>${escapeHtml(u.email)}</td><td>${u.count}</td></tr>`);
        html += `</tbody></table>`;
        up.innerHTML += html;
      }
      adminPanelsContainer.appendChild(up);

      // add event panel button area
      const addp = document.createElement('div'); addp.className='panel';
      addp.innerHTML = `<h2>Add New Event</h2>
        <div style="display:flex;gap:8px;flex-wrap:wrap">
          <input id="newTitle" placeholder="Title" style="padding:8px;border-radius:8px;border:1px solid #e2e8f0;width:220px" />
          <input id="newCity" placeholder="City" style="padding:8px;border-radius:8px;border:1px solid #e2e8f0;width:140px"/>
          <input id="newDate" placeholder="YYYY-MM-DD" style="padding:8px;border-radius:8px;border:1px solid #e2e8f0;width:130px"/>
          <input id="newPrice" placeholder="Price (₹)" style="padding:8px;border-radius:8px;border:1px solid #e2e8f0;width:110px"/>
          <input id="newTag" placeholder="Tag" style="padding:8px;border-radius:8px;border:1px solid #e2e8f0;width:120px"/>
          <button id="addEventBtn" class="btn">Add Event</button>
        </div>
        <div class="small" style="margin-top:8px">Tip: Enter date like 2025-12-01</div>
      `;
      adminPanelsContainer.appendChild(addp);

      // attach handlers for cancel booking & add event
      document.querySelectorAll('.cancelBooking').forEach(btn=>{
        btn.addEventListener('click', e=>{
          const id = Number(e.currentTarget.dataset.id);
          if(!confirm('Cancel this booking?')) return;
          bookings = bookings.filter(b => b.id !== id);
          saveBookings(bookings);
          refreshAdminPanels();
          showAdminMessage('Booking cancelled.');
        });
      });

      document.getElementById('addEventBtn').addEventListener('click', ()=>{
        const title = document.getElementById('newTitle').value.trim();
        const city = document.getElementById('newCity').value.trim();
        const date = document.getElementById('newDate').value.trim();
        const price = Number(document.getElementById('newPrice').value.trim());
        const tag = document.getElementById('newTag').value.trim();
        if(!title||!city||!date||!price){ alert('Please fill title, city, date and price'); return; }
        const id = Date.now() + Math.floor(Math.random()*1000);
        const newEv = { id, title, city, date, price, rating:4.0, reviews:0, tag };
        events.push(newEv); saveEvents(events);
        renderList(eventsFiltered());
        refreshAdminPanels();
        showAdminMessage('Event added.');
        // clear inputs
        document.getElementById('newTitle').value=''; document.getElementById('newCity').value=''; document.getElementById('newDate').value=''; document.getElementById('newPrice').value=''; document.getElementById('newTag').value='';
      });

      // delete buttons on cards re-bound when admin true
      document.querySelectorAll('.delBtn').forEach(b=>b.addEventListener('click', e=>{
        const id = Number(e.currentTarget.dataset.id);
        if(!confirm('Delete event?')) return;
        events = events.filter(x=>x.id!==id); saveEvents(events); renderList(eventsFiltered()); refreshAdminPanels(); showAdminMessage('Event deleted.');
      }));
    }

    function uniqueUsers(){
      const map = {};
      bookings.forEach(b=>{
        const key = b.email.toLowerCase();
        if(!map[key]) map[key] = { name:b.name, email:b.email, count:0 };
        map[key].count += 1;
      });
      return Object.values(map);
    }

    function showAdminMessage(msg){
      const el = document.createElement('div'); el.className='panel';
      el.innerHTML = `<div class="small">${escapeHtml(msg)}</div>`;
      adminPanelsContainer.prepend(el);
      setTimeout(()=>{ try{ el.remove() }catch(e){} }, 3000);
    }

    // expose admin buttons
    showAddEvent.addEventListener('click', ()=> {
      if(!isAdmin) return;
      window.scrollTo({top:0,behavior:'smooth'});
      refreshAdminPanels();
    });
    viewBookingsBtn.addEventListener('click', ()=>{ if(!isAdmin) return; refreshAdminPanels(); window.scrollTo({top:document.body.scrollHeight,behavior:'smooth'}); });
    viewUsersBtn.addEventListener('click', ()=>{ if(!isAdmin) return; refreshAdminPanels(); window.scrollTo({top:document.body.scrollHeight,behavior:'smooth'}); });

    // --- small helpers ---
    function escapeHtml(s){ return String(s).replace(/[&<>"']/g, (m)=> ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m]) ); }

    // initial: if bookings exist but admin not logged in, still load them
    bookings = loadBookings();
    events = loadEvents();

    // render list
    renderList(eventsFiltered());

    // keyboard: press "a" to open admin login (convenience)
    document.addEventListener('keydown', e=>{ if(e.key==='a' && !isAdmin){ adminLoginBackdrop.style.display='flex'; adminLoginBackdrop.setAttribute('aria-hidden','false'); } });

    // end of script
  </script>
</body>
</html>
