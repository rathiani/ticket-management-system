<!DOCTYPE html>
<html lang="ta">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Event List & Payment Demo</title>
  <style>
    /* Basic reset */
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body { font-family: "Segoe UI", Roboto, Arial, sans-serif; background:#f5f7fb; color:#222; line-height:1.4; padding:20px; }

    header { display:flex; align-items:center; justify-content:space-between; gap:1rem; margin-bottom:18px; }
    h1 { font-size:1.4rem; color:#0f172a; }
    .subtitle { color:#556; font-size:0.95rem; }

    /* Grid of event cards */
    .grid { display:grid; grid-template-columns: repeat(auto-fill,minmax(260px,1fr)); gap:16px; margin-top:16px; }

    .card {
      background: #fff;
      border-radius:12px;
      padding:14px;
      box-shadow: 0 6px 18px rgba(20,20,40,0.06);
      display:flex;
      flex-direction:column;
      gap:10px;
      min-height:170px;
    }
    .card .top { display:flex; justify-content:space-between; align-items:start; gap:10px; }
    .card .info { flex:1; }
    .badge { font-size:0.8rem; padding:6px 8px; background:linear-gradient(90deg,#6ee7b7,#3b82f6); color:white; border-radius:8px; display:inline-block; }
    .event-title { font-weight:700; font-size:1.05rem; margin-bottom:6px; }
    .meta { color:#556; font-size:0.9rem; margin-bottom:6px; }

    .rating {
      display:flex; align-items:center; gap:6px; font-size:0.95rem;
    }
    .stars { display:inline-flex; gap:2px; }
    .star { width:18px; height:18px; display:inline-block; }
    .price { font-weight:700; color:#0b5394; font-size:1.05rem; }

    .card .actions { margin-top:auto; display:flex; gap:8px; align-items:center; justify-content:space-between; }
    button.btn {
      padding:8px 12px; border-radius:10px; border:0; cursor:pointer; font-weight:600;
      background:#0b73ff; color:white;
    }
    button.btn.secondary { background:#eef2ff; color:#0b73ff; border:1px solid rgba(11,115,255,0.12); }

    /* Search & filters */
    .controls { display:flex; gap:8px; align-items:center; margin-top:8px; flex-wrap:wrap; }
    input.search { padding:8px 10px; border-radius:10px; border:1px solid #d6dbe6; min-width:220px; }
    select { padding:8px 10px; border-radius:10px; border:1px solid #d6dbe6; }

    /* Modal */
    .modal-backdrop {
      position:fixed; inset:0; display:none; align-items:center; justify-content:center; background:rgba(6,10,20,0.5); z-index:60;
    }
    .modal {
      width:100%; max-width:560px; background:white; border-radius:12px; padding:18px; box-shadow:0 20px 50px rgba(2,6,23,0.35);
    }
    .modal header { display:flex; justify-content:space-between; align-items:center; margin-bottom:12px; }
    .modal .row { display:flex; gap:10px; margin-bottom:10px; }
    .modal label { font-size:0.85rem; color:#334155; margin-bottom:6px; display:block; }
    .modal input[type="text"], .modal input[type="email"], .modal input[type="tel"], .modal select {
      width:100%; padding:10px 12px; border-radius:8px; border:1px solid #d6dbe6;
    }
    .inline { display:flex; gap:8px; }
    .small { flex:1; min-width:0; }

    .note { font-size:0.85rem; color:#556; margin-top:8px; }

    .close-btn { background:transparent; border:0; font-size:1.1rem; cursor:pointer; color:#444; }

    /* success message */
    .success { padding:14px; border-radius:10px; background:linear-gradient(90deg,#dcfce7,#bbf7d0); color:#064e3b; font-weight:700; text-align:center; }

    /* responsive tweaks */
    @media (max-width:520px){
      header { flex-direction:column; align-items:flex-start; gap:6px; }
      .controls { width:100%; gap:6px; }
    }
  </style>
</head>
<body>

  <header>
    <div>
      <h1>Events List</h1>
      <div class="subtitle">பல event-கள் — ரேட்டிங், விலை மற்றும் payment சிக்கல் உண்டு. (Demo)</div>
    </div>
    <div class="controls">
      <input id="searchInput" class="search" placeholder="Search events (name, city)..." />
      <select id="sortSelect" title="Sort">
        <option value="popular">Sort: Most Popular</option>
        <option value="price-asc">Price: Low → High</option>
        <option value="price-desc">Price: High → Low</option>
        <option value="date">Date</option>
      </select>
    </div>
  </header>

  <main>
    <div id="grid" class="grid" aria-live="polite"></div>
  </main>

  <!-- Payment Modal -->
  <div id="modalBackdrop" class="modal-backdrop" role="dialog" aria-modal="true" aria-hidden="true">
    <div class="modal" role="document">
      <header>
        <div>
          <div id="modalEventTitle" style="font-weight:800"></div>
          <div id="modalEventMeta" style="color:#475569;font-size:0.95rem"></div>
        </div>
        <div>
          <button class="close-btn" id="modalClose">&times;</button>
        </div>
      </header>

      <form id="paymentForm" novalidate>
        <div style="display:flex; gap:10px; align-items:center;">
          <div class="badge" id="modalPrice">₹0</div>
          <div style="flex:1;">
            <label for="name">பெயர்</label>
            <input id="name" type="text" placeholder="உங்கள் முழுப் பெயர்" required />
          </div>
        </div>

        <div class="row">
          <div style="flex:1;">
            <label for="email">Email</label>
            <input id="email" type="email" placeholder="you@example.com" required />
          </div>
          <div style="width:140px;">
            <label for="tickets">Tickets</label>
            <select id="tickets">
              <option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option>
            </select>
          </div>
        </div>

        <!-- Fake card fields (for demo only) -->
        <div>
          <label for="card">Card Number</label>
          <input id="card" type="text" inputmode="numeric" placeholder="4111 1111 1111 1111" maxlength="19" required />
        </div>

        <div class="row">
          <div class="small">
            <label for="exp">Expiry (MM/YY)</label>
            <input id="exp" type="text" placeholder="MM/YY" maxlength="5" required />
          </div>
          <div style="width:120px;">
            <label for="cvv">CVV</label>
            <input id="cvv" type="tel" maxlength="4" placeholder="123" required />
          </div>
        </div>

        <div style="display:flex; gap:8px; margin-top:12px; align-items:center;">
          <button id="payBtn" class="btn" type="submit">Pay Now</button>
          <button id="payLater" type="button" class="btn secondary">Pay at Venue</button>
        </div>

        <div class="note">**This is a demo payment form** — no real transactions are processed. Use sample numbers for testing.</div>
      </form>

      <div id="paymentResult" style="display:none; margin-top:12px;"></div>
    </div>
  </div>

  <script>
    // Sample event data
    const events = [
      { id:1, title:"Summer Music Festival", city:"Chennai", date:"2025-10-12", price:999, rating:4.7, reviews:128, tag:"Music" },
      { id:2, title:"Tech Summit 2025", city:"Bengaluru", date:"2025-11-05", price:2499, rating:4.9, reviews:850, tag:"Tech" },
      { id:3, title:"Food Carnival", city:"Hyderabad", date:"2025-09-30", price:499, rating:4.2, reviews:64, tag:"Food" },
      { id:4, title:"Art & Crafts Expo", city:"Puducherry", date:"2025-10-20", price:299, rating:4.0, reviews:34, tag:"Art" },
      { id:5, title:"Stand-up Night", city:"Coimbatore", date:"2025-12-02", price:799, rating:4.5, reviews:210, tag:"Comedy" },
      { id:6, title:"Marathon 10K", city:"Madurai", date:"2025-11-15", price:399, rating:4.3, reviews:430, tag:"Sports" }
	  ];

    // Utility: render stars for a rating (0-5)
    function renderStars(r) {
      const full = Math.floor(r);
      const half = (r - full) >= 0.5;
      let out = '';
      for (let i=0;i<full;i++) out += '<svg class="star" viewBox="0 0 24 24" fill="#fbbf24" xmlns="http://www.w3.org/2000/svg"><path d="M12 .587l3.668 7.431 8.2 1.192-5.934 5.788 1.402 8.174L12 18.896l-7.336 3.276 1.403-8.174L.133 9.21l8.2-1.192L12 .587z"/></svg>';
      if (half) out += '<svg class="star" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><defs><linearGradient id="g"><stop offset="50%" stop-color="#fbbf24"/><stop offset="50%" stop-color="#e6e6e6"/></linearGradient></defs><path d="M12 .587l3.668 7.431 8.2 1.192-5.934 5.788 1.402 8.174L12 18.896l-7.336 3.276 1.403-8.174L.133 9.21l8.2-1.192L12 .587z" fill="url(#g)"/></svg>';
      const rem = 5 - full - (half?1:0);
      for (let i=0;i<rem;i++) out += '<svg class="star" viewBox="0 0 24 24" fill="#e6e6e6" xmlns="http://www.w3.org/2000/svg"><path d="M12 .587l3.668 7.431 8.2 1.192-5.934 5.788 1.402 8.174L12 18.896l-7.336 3.276 1.403-8.174L.133 9.21l8.2-1.192L12 .587z"/></svg>';
      return out;
    }

    // Render grid
    const grid = document.getElementById('grid');
    function renderList(list) {
      grid.innerHTML = '';
      if (list.length === 0) {
        grid.innerHTML = '<div style="grid-column:1/-1;padding:18px;background:#fff;border-radius:10px;text-align:center;color:#475569">No events found.</div>';
        return;
      }
      list.forEach(ev => {
        const div = document.createElement('div');
        div.className = 'card';
        div.innerHTML = `
          <div class="top">
            <div class="info">
              <div class="event-title">${escapeHtml(ev.title)}</div>
              <div class="meta">${escapeHtml(ev.city)} • ${formatDate(ev.date)}</div>
            </div>
            <div style="text-align:right">
              <div class="badge">${escapeHtml(ev.tag)}</div>
              <div style="margin-top:8px" class="price">₹${ev.price}</div>
            </div>
          </div>

          <div class="rating" aria-label="Rating ${ev.rating} out of 5">
            <div class="stars">${renderStars(ev.rating)}</div>
            <div style="font-size:0.9rem;color:#334155">${ev.rating.toFixed(1)} <span style="color:#94a3b8;font-size:0.85rem">(${ev.reviews})</span></div>
          </div>

          <div class="actions">
            <div style="color:#64748b;font-size:0.92rem">Date: ${formatDate(ev.date)}</div>
            <div>
              <button class="btn" data-id="${ev.id}">Book</button>
              <button class="btn secondary" data-id="${ev.id}" aria-label="Details for ${escapeHtml(ev.title)}">Details</button>
            </div>
          </div>
        `;
        grid.appendChild(div);
      });

      // attach handlers
      document.querySelectorAll('.card .btn').forEach(btn=>{
        btn.addEventListener('click', openPayment);
      });
      document.querySelectorAll('.card .btn.secondary').forEach(b=>{
        b.addEventListener('click', (e)=>{
          const id = parseInt(e.currentTarget.getAttribute('data-id'));
          const ev = events.find(x=>x.id===id);
          alert(`${ev.title}\n\nWhere: ${ev.city}\nWhen: ${formatDate(ev.date)}\nPrice: ₹${ev.price}\nRating: ${ev.rating.toFixed(1)} (${ev.reviews} reviews)`);
        });
      });
    }

    // helpers
    function formatDate(d) {
      const dt = new Date(d + 'T00:00:00');
      const opts = { year:'numeric', month:'short', day:'numeric' };
      return dt.toLocaleDateString('en-GB', opts);
    }
    function escapeHtml(s) { return String(s).replace(/[&<>"']/g, (m)=> ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m])); }

    // Search & sort
    const searchInput = document.getElementById('searchInput');
    const sortSelect = document.getElementById('sortSelect');

    function applyFilters() {
      const q = searchInput.value.trim().toLowerCase();
      let filtered = events.filter(ev => (ev.title + ' ' + ev.city + ' ' + ev.tag).toLowerCase().includes(q));
      const sort = sortSelect.value;
      if (sort === 'popular') filtered.sort((a,b)=> b.rating - a.rating || b.reviews - a.reviews);
      else if (sort === 'price-asc') filtered.sort((a,b)=> a.price - b.price);
      else if (sort === 'price-desc') filtered.sort((a,b)=> b.price - a.price);
      else if (sort === 'date') filtered.sort((a,b)=> new Date(a.date) - new Date(b.date));
      renderList(filtered);
    }

    searchInput.addEventListener('input', applyFilters);
    sortSelect.addEventListener('change', applyFilters);

    // Modal logic
    const modalBackdrop = document.getElementById('modalBackdrop');
    const modalClose = document.getElementById('modalClose');
    const modalEventTitle = document.getElementById('modalEventTitle');
    const modalEventMeta = document.getElementById('modalEventMeta');
    const modalPrice = document.getElementById('modalPrice');
    const paymentForm = document.getElementById('paymentForm');
    const paymentResult = document.getElementById('paymentResult');

    let selectedEvent = null;

    function openPayment(e) {
      const id = parseInt(e.currentTarget.getAttribute('data-id'));
      selectedEvent = events.find(x=>x.id===id);
      modalEventTitle.textContent = selectedEvent.title;
      modalEventMeta.textContent = `${selectedEvent.city} • ${formatDate(selectedEvent.date)}`;
      modalPrice.textContent = `₹${selectedEvent.price}`;
      paymentResult.style.display = 'none';
      paymentForm.style.display = 'block';
      modalBackdrop.style.display = 'flex';
      modalBackdrop.setAttribute('aria-hidden','false');

      // reset form
      paymentForm.reset();
      document.getElementById('tickets').value = '1';
      document.getElementById('name').focus();
    }
    modalClose.addEventListener('click', closeModal);
    modalBackdrop.addEventListener('click', (ev)=>{
      if (ev.target === modalBackdrop) closeModal();
    });
    function closeModal(){
      modalBackdrop.style.display = 'none';
      modalBackdrop.setAttribute('aria-hidden','true');
    }

    // Basic client-side validation & simulate payment
    paymentForm.addEventListener('submit', function(evt){
      evt.preventDefault();
      // gather
      const name = document.getElementById('name').value.trim();
      const email = document.getElementById('email').value.trim();
      const tickets = parseInt(document.getElementById('tickets').value,10);
      const card = document.getElementById('card').value.replace(/\s+/g,'');
      const exp = document.getElementById('exp').value.trim();
      const cvv = document.getElementById('cvv').value.trim();

      // simple checks
      if (!name || !email) { alert('Name and email required'); return; }
      if (!/^\d{13,19}$/.test(card)) { alert('Please enter a valid card number (digits only for demo).'); return; }
      if (!/^\d{2}\/\d{2}$/.test(exp)) { alert('Expiry must be MM/YY'); return; }
      if (!/^\d{3,4}$/.test(cvv)) { alert('Enter 3 or 4 digit CVV'); return; }

      // compute total
      const total = selectedEvent.price * tickets;
      // simulate processing...
      paymentForm.style.display = 'none';
      paymentResult.style.display = 'block';
      paymentResult.innerHTML = '<div style="padding:16px">Processing payment...</div>';

      // fake delay (simulate)
      setTimeout(()=>{
        paymentResult.innerHTML = `<div class="success">Payment Successful!<br/>You booked <strong>${escapeHtml(selectedEvent.title)}</strong><br/>Tickets: ${tickets} — Paid ₹${total}</div>`;
      }, 900);
    });

    // Pay at venue
    document.getElementById('payLater').addEventListener('click', ()=>{
      const tickets = parseInt(document.getElementById('tickets').value,10);
      const total = selectedEvent.price * tickets;
      paymentForm.style.display = 'none';
      paymentResult.style.display = 'block';
      paymentResult.innerHTML = `<div class="success">Booking confirmed!<br/>Pay ₹${total} at venue for <strong>${escapeHtml(selectedEvent.title)}</strong>.</div>`;
    });

    // formatting card input with spaces
    const cardInput = document.getElementById('card');
    cardInput.addEventListener('input', (e)=>{
      let v = e.target.value.replace(/\D/g,'').slice(0,19);
      v = v.match(/.{1,4}/g)?.join(' ') || v;
      e.target.value = v;
    });

    // expiry formatting
    document.getElementById('exp').addEventListener('input', (e)=>{
      let v = e.target.value.replace(/\D/g,'').slice(0,4);
      if (v.length >= 3) v = v.slice(0,2) + '/' + v.slice(2);
      e.target.value = v;
    });

    // initial render
    renderList(events);
    applyFilters();
  </script>
</body>
</html>
